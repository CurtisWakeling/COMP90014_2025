
# Assignment 1


**Academic integrity**

This assignment should be completed by each student individually. <br>
Make sure you read this entire document, and ask for help if anything is not clear. <br>
Any changes or clarifications to this document will be announced via the LMS. <br>

Please make sure you review the University's rules on academic honesty and plagiarism: https://academichonesty.unimelb.edu.au/

Do not copy any code from other students. This is considered plagiarism.

Any ***small blocks*** of code (single line, small function) copied from the internet must be appropriately cited, including LLM output such as ChatGPT, Gemini, Claude etc. ***Large blocks*** of code (>10 lines) are not permitted. 

To cite code, include a comment above the section of code which was used. This comment should provide a URL link to the webpage, or the name of the LLM used. 

**Submission**

Your completed `A1.py` file will be turned in via LMS.

We use Turnitin for all assignments, which will compare your code to other students for similarity. It also compares your code against the web and estimates what proportion was generated by an LLM. 


-----------

### Prompt 

This assignment implements a solution to a ***real enquiry*** received by Melbourne Bioinformatics.  The task has been ***modified slightly***, but remains largely the same. 

The enquiry was received from a biotech firm developing *oligonucleotide therapeutics*. 
These are typically short (up to 50bp), single-stranded pieces of RNA which bind specific mRNA molecules to either increase or decrease production of the corresponding protein. 

The firm has a list of candidate oligonucleotide sequences (oligos) available to test. For each oligo, they want to know whether it binds to their target gene, and if so, whether it also binds to other undesired genes (off-target). The best candidate oligo would be specific to their target gene - ie does not bind to off-target genes. 

Rather than reveal their target gene or list of oligos, they would like Melbourne Bioinformatics to design custom software to do this in an automated manner. 

--------

### Program Specifications for this Assignment 

Your task is to design a program which can identify which genes oligos will bind to. 

For this assignment, we will define 'bind' as:
- The oligo *exactly* matches part of a gene, or
- The oligo has no more than one (1) *mismatch* to part of a gene. <br>

i.e. The hamming distance between the oligo and part of the gene is <= 1.

You ***do not*** need to reverse-complement or translate any sequence (oligos or genes). 
Simply identify if a given oligo matches part of a gene. 

**Inputs**

The program should accept as input:
- A file containing a list of oligos to assess `--oligos`.
- A file containing a database of human genes and their coding sequences `--database`.
- An output filepath to write results to `--outfile`.

Example:
```
python A1.py --oligos [path] --database [path] --outfile [path]
```

>Assumptions you can make regarding the inputs:
>- Oligo size will always be an ***odd number*** (eg 11, 15, 19)
>- Oligo size will never be greater than 49.
>- All oligos in the `--oligos` input will have the same length.
>- Min sequence length of genes in database == 200
>- Max sequence length of genes in database == 5000
>- Some oligos ***exactly*** match the WNT4 gene and no others.
>- Some oligos ***inexactly*** match the WNT4 gene and no others.
>- Some oligos ***do not*** match the WNT4 gene. 
>- The above three statements are true for all other genes. 

**Outputs**

The program should output:
- A single .tsv (tab seperated) file.

For this assignment we will assume the target gene of interest is the `WNT4` gene. 
The output file should therefore have the following structure:
- Column 1: The oligo being assessed.
- Column 2: True if the oligo matches the WNT4 gene (up to 1 mismatch) else False.
- Column 3: Comma-separated string of other genes the oligo matches (up to 1 mismatch). 

Here is an explanation of how the file should be structured.
```
oligo	    WNT4	off_target
ACCAAAGGCAA	True	                     # oligo binds WNT4 only
AAACCAGAGAG	True	BCL6,MYBPC1          # oligo binds WNT4 + others
TGAGACAATCT	False	TMPRSS2,ZC3H7A       # oligo only binds other genes
TTCGTTGGGAC	False	                     # oligo does not bind any gene in database
```

Example files are available in the `./test_data/expected` directory. 

These can be used validate the correctness of your `A1.py` program.


--------

### Test Suite

`A1test.py` runs performance and output similarity tests. 

It takes no arguments, so you can just use `python A1test.py` to run the test suite. 

>***Note***<br>
> If the `test_data` folder is moved or altered in any way, the test suite may fail. <br>

For each test, the following is reported:
- Runtime and peak memory usage.
- Whether your A1.py created an output file in the correct location (`--outfile`).
- Whether your output file had the intended structure (.tsv file, 3 columns, value types etc).
- Whether all oligos in the input file (`--oligos`) are present in the output file. 
- The similarity between your output file and the expected output file. 

You can select which tests to run by altering the following constants.
```
RUN_BASIC = True 
RUN_OLIGO_LENGTHS = True 
RUN_OLIGO_COUNTS = True 
RUN_GENE_COUNTS = True 
USE_LARGE_DB = False
```

--------

### Completing the Assignment

1. Clone or pull updates from the [COMP90014 github repository](https://github.com/melbournebioinformatics/COMP90014_2025) to your computer. 
2. Copy the `A1` folder (`COMP90014_2025/assignments/A1`) and paste it somewhere else on your computer. 
3. Open Visual Studio Code to your copy local of the `A1` folder.
4. Complete the `A1.py` file then upload to the LMS.

We advise you create a `venv` or `conda` (not recommended) virtual environment for the project. The only requirement is `pandas`.

**Unix Operating System**

If you have a windows PC (like me), ensure you have installed WSL and have connected to WSL when using visual studio code. 

Instructions for how to do this are available in the main README.md file of the [COMP90014 github repository](https://github.com/melbournebioinformatics/COMP90014_2025).

**Project Structure**

Your workspace should have the following structure before you begin. 

```
├── A1.py       # implement your program in the main() function of this file.
├── A1test.py   # run this file (eg `python A1test.py`) to run the test suite.
├── README.md
├── results     # write output files to this directory (A1test.py writes here too).
└── test_data   
    ├── databases               # test suite: gene sequences
    │   ├── 1000_genes.tsv
    │   ├── 100_genes.tsv
    │   └── 10_genes.tsv
    ├── expected                # test suite: expected output of your A1.py
    │   ├── 11_mer.500_oligos.1000_genes.tsv
    │   ├── 11_mer.500_oligos.100_genes.tsv
    │   ├── 15_mer.100_oligos.1000_genes.tsv
    │   ├── 15_mer.100_oligos.100_genes.tsv
    │   ├── 15_mer.100_oligos.10_genes.tsv
    │   ├── 15_mer.2500_oligos.1000_genes.tsv
    │   ├── 15_mer.2500_oligos.100_genes.tsv
    │   ├── 15_mer.500_oligos.1000_genes.tsv
    │   ├── 15_mer.500_oligos.100_genes.tsv
    │   ├── 15_mer.500_oligos.10_genes.tsv
    │   ├── 19_mer.500_oligos.1000_genes.tsv
    │   └── 19_mer.500_oligos.100_genes.tsv
    └── oligos                  # test suite: oligos to assess
        ├── 100_oligos.15_mer.txt
        ├── 2500_oligos.15_mer.txt
        ├── 500_oligos.11_mer.txt
        ├── 500_oligos.15_mer.txt
        └── 500_oligos.19_mer.txt
```

**Your Solution**

To complete the assignment, implement your solution in `A1.py`.

You will need to write functions which:
- Read input files.
- Write the single output file to disk.
- Compare an oligo to a gene sequence.
- Generate helpful datastructures to speed up runtime. 

These should be called from the `main()` function. 

The logic to accept user input has been implemented for you (argparse). In addition, the logic to profile runtime and memory usage are already present. If you alter this, `A1test.py` will no longer function normally. 

***Remember to save your work early and often.***

-----------

### Marking

**Test files**

The input files we use to validate your code are similar to those in the `test_data` folder. They are not identical, so it's up to you to decide whether your code is correct.

**General marking guide**

- Correctness (60%)<br>
How similar your output files are to the expected output files.<br>
This is assessed on small inputs only (100 gene database, 100 oligos).
- Runtime efficiency (15%)<br>
How your solution scales with number of genes, number of oligos, and oligo size.<br>
- Space efficiency (15%)<br>
As above.
- Code structure / readability (10%)<br>
A1.py has comments, functions are not 100 lines long (10 is a good length) etc. 

**A Reminder About Performance Marks**

Runtime efficiency only accounts for 15% of the marks for this assignment. 

We recommend you start with the simplest solution which returns correct output, then try more efficient approaches if time permits. 

>Hint: A brute force solution exists which consumes almost zero memory, but is very slow. 


**Slight differences between output & expected output**

There may be some slight difference between your output files and expected output files. 
Sometimes this will be due to your A1.py solution, other times the expected output file itself is incorrect. No marks will be deducted for subtle differences. 


**Reference solution** 

This is our solution to the assignment (not visible to you). <br>
It scales linearly with both the number of genes & number of oligos.

For the largest test (oligo size: 15, num oligos: 2500, num genes: 1000) 
- Runtime: 3 seconds
- Peak memory: 632 mb

Test computer: AMD Ryzen 9 3900x (3.8 GHz base clock), 64 Gb mem

Your solution does not need similar performance for a good mark, but try to beat this if you want a challenge. 

